
<!DOCTYPE html>
<html>
<head>
<title>系统用户表新增、编辑</title>
   <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!--css样式-->
    <link href="scripts/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="scripts/bootstrap-table/bootstrap-table.css" rel="stylesheet">
    <!--js-->

    <script src="scripts/jquery/jquery-3.2.0.min.js"></script>
    <script src="scripts/bootstrap/js/bootstrap.js"></script>
    <script src="scripts/bootstrap-table/bootstrap-table.js"></script>
    <script src="scripts/bootstrap-table/locale/bootstrap-table-zh-CN.js"></script>
    <script src="scripts/bootstrap-table/extensions/multiple-sort/bootstrap-table-multiple-sort.js"></script>

    <link href="scripts/x-editable/bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet">
    <script src="scripts/bootstrap-table/extensions/editable/bootstrap-table-editable.js"></script>
    <script src="scripts/x-editable/bootstrap3-editable/js/bootstrap-editable.js"></script>

    <script src="scripts/bootstrap-table/extensions/export/tableExport.js"></script>
    <script src="scripts/bootstrap-table/extensions/export/bootstrap-table-export.js"></script>

    <link href="scripts/bootstrap-treeview/bootstrap-treeview.css" rel="stylesheet">
    <script src="scripts/bootstrap-treeview/bootstrap-treeview.min.js"></script>

    <link href="scripts/BootStrap-addTabs/bootstrap.addtabs.css" rel="stylesheet">
    <script src="scripts/BootStrap-addTabs/bootstrap.addtabs.js"></script>

    <script src="scripts/bootbox/bootbox.min.js"></script>

    <link href="scripts/bootstrap3-dialog/css/bootstrap-dialog.css" rel="stylesheet">
    <script src="scripts/bootstrap3-dialog/js/bootstrap-dialog.js"></script>
    <script src="scripts/bootstrap3-dialog/bootstrap3-dialog-ext.js"></script>

    <script src="scripts/bootstrap-datetimepicker/js/moment.js"></script>
    <script src="scripts/bootstrap-datetimepicker/js/moment_zh-CN.js"></script>
    <link href="scripts/bootstrap-datetimepicker/css/bootstrap-datetimepicker.css" rel="stylesheet">
    <script src="scripts/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
    <script src="scripts/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js"></script>

    <link href="scripts/bootstrapvalidator/css/bootstrapValidator.css" rel="stylesheet">
    <script src="scripts/bootstrapvalidator/js/bootstrapValidator.js"></script>
    <script src="scripts/bootstrapvalidator/js/language/zh_CN.js"></script>


    <link href="scripts/Magnific-Popup/magnific-popup.css" rel="stylesheet">
    <script src="scripts/Magnific-Popup/jquery.magnific-popup.js"></script>


    <script src="scripts/jquery/jqueryui/jquery-ui-1.8.1.custom.min.js" type="text/javascript"></script>

    <link href="scripts/bootstrap-fileinput/css/fileinput.css" rel="stylesheet">
    <script src="scripts/bootstrap-fileinput/js/fileinput.js"></script>


    <link href="scripts/bootstrap-wysihtml5/bootstrap3-wysihtml5.css" rel="stylesheet">
    <script src="scripts/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.js"></script>

    <script src="scripts/jquery.cookie.js"></script>
    <script src="scripts/common.js"></script>
	
</head>
<body>
<div class="container">
	<form  class="form-horizontal" method="post" name="upmUserForm" id="upmUserForm">
	<input type="hidden" name="id" id="id" />
	<input type="hidden" name="operate" id="operate"  />
           
      		<div class="form-group">
			 <label for="id">ID</label>
		 	     <input class="form-control" type="text"  name="id" id="id"  />
		 	</div>
      		<div class="form-group">
			 <label for="userNo">登陆账号</label>
		 	     <input class="form-control" type="text"  name="userNo" id="userNo"  />
		 	</div>
      		<div class="form-group">
			 <label for="userPass">登陆密码</label>
		 	     <input class="form-control" type="text"  name="userPass" id="userPass"  />
		 	</div>
      		<div class="form-group">
			 <label for="createUserId">创建人</label>
		 	     <input class="form-control" type="text"  name="createUserId" id="createUserId"  />
		 	</div>
      		<div class="form-group">
			 <label for="createUserName">创建人姓名</label>
		 	     <input class="form-control" type="text"  name="createUserName" id="createUserName"  />
		 	</div>
      		<div class="form-group">
			 <label for="createTime">创建时间</label>
				<input class="form-control" type="text" name="createTime" id = "createTime"  class="datetimepicker"  readonly="readonly"/>
		 	</div>
      		<div class="form-group">
			 <label for="updateUserId">更新人</label>
		 	     <input class="form-control" type="text"  name="updateUserId" id="updateUserId"  />
		 	</div>
      		<div class="form-group">
			 <label for="updateUserName">更新人姓名</label>
		 	     <input class="form-control" type="text"  name="updateUserName" id="updateUserName"  />
		 	</div>
      		<div class="form-group">
			 <label for="updateTime">更新时间</label>
				<input class="form-control" type="text" name="updateTime" id = "updateTime"  class="datetimepicker"  readonly="readonly"/>
		 	</div>
       
 	  <div class="form-group"> 
                 <button id="save"  class="btn btn-default">保存</button>
                <button type="button" id="backToHomeButton"  class="btn btn-default">返回</button>
        </div>	
       
    	</form>
</div>
<script>
		 //拦截器判断
        var token = $.cookie('bearcktkaeskey');
        if (token == ""||token==undefined) {
            location.href = ctx + '/login.html';
        }

        $(function () {
            //截取参数
            $.getUrlParam = function (name) {
                var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
                var r = window.location.search.substr(1).match(reg);
                if (r != null) return unescape(r[2]);
                return null;
            }

            var id = $.getUrlParam('id');
            var operate = $.getUrlParam('operate');
            
            if(id != null){
                $("#id").val(id);
                $.ajax({
                    url: ctx+"/api/UpmUser/"+id+"?TOKEN="+token,
                    type: "get",
                    dataType: "json",
                    success: function(data){
                            $("#id").val(data.id);
                            $("#userNo").val(data.userNo);
                            $("#userPass").val(data.userPass);
                            $("#createUserId").val(data.createUserId);
                            $("#createUserName").val(data.createUserName);
                            $("#createTime").val(data.createTime);
                            $("#updateUserId").val(data.updateUserId);
                            $("#updateUserName").val(data.updateUserName);
                            $("#updateTime").val(data.updateTime);
                    },
                    error: function(data){
                        bootbox.alert("异常");
                        return false;
                    }
                });
            }
          $("#upmUserForm").bootstrapValidator({
			
			fields: {
		 		 "id": {
					message: 'ID不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: 'ID不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "userNo": {
					message: '登陆账号不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '登陆账号不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "userPass": {
					message: '登陆密码不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '登陆密码不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "createUserId": {
					message: '创建人不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '创建人不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "createUserName": {
					message: '创建人姓名不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '创建人姓名不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "createTime": {
					message: '创建时间不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '创建时间不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "updateUserId": {
					message: '更新人不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '更新人不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "updateUserName": {
					message: '更新人姓名不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '更新人姓名不能为空'  
                        			} 
                        			
                    			}  
				
		       },
		 		 "updateTime": {
					message: '更新时间不能为空',
					validators: {  
                       				 notEmpty: {  
                        				message: '更新时间不能为空'  
                        			} 
                        			
                    			}  
				
		       }
		    }
		}
 		);
		
            $("#save").click(function () {//非submit按钮点击后进行验证，如果是submit则无需此句直接验证
                $("#upmUserForm").bootstrapValidator('validate');//提交验证
                if ($("#upmUserForm").data('bootstrapValidator').isValid()) {//获取验证结果，如果成功，执行下面代码
                    var type = "post";
                    var url = ctx + "/api/UpmUser?TOKEN="+token;
                    if (operate == "edit"){
                        type = "put";
                        url = ctx + "/api/UpmUser/"+id+"?TOKEN="+token;
                    }else {
                    	$("#id").val(0);
                    }
                    $.ajax({
                        url: url,
                        data: {
						      "id":$("#id").val(),
						      "userNo":$("#userNo").val(),
						      "userPass":$("#userPass").val(),
						      "createUserId":$("#createUserId").val(),
						      "createUserName":$("#createUserName").val(),
    						 "createTimeBegin":createTimeBegin,
    						 "createTimeEnd":createTimeEnd ,
						      "updateUserId":$("#updateUserId").val(),
						      "updateUserName":$("#updateUserName").val(),
    						 "updateTimeBegin":updateTimeBegin,
    						 "updateTimeEnd":updateTimeEnd 
                        },
                        type: type,
                        dataType: "json",
                        success: function (data) {
                            bootbox.alert(data.respMsg);
                        },
                        error: function (data) {
                            bootbox.alert("异常");
                            return false;
                        }
                    });
                }

            });

            $("#backToHomeButton").click(function () {
                window.history.go(-1);
            });
        });
</script>
</body>
</html>
